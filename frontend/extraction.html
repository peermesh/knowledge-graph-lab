<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entity Extraction - Knowledge Graph Lab</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%233b82f6'/%3E%3Cstop offset='100%25' stop-color='%2314b8a6'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='url(%23grad)'/%3E%3Cpath d='M20 22h24v4H20zm0 18h24v4H20zm0-9h18v4H20z' fill='%23e0f2fe'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://unpkg.com/vis-network@9.1.2/styles/vis-network.min.css">
    <style>
        .extraction-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            height: calc(100vh - 200px);
        }
        
        .input-panel {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .output-panel {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .json-output {
            flex: 1;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            padding: 1rem;
            overflow: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .json-output pre {
            margin: 0;
            color: #e2e8f0;
        }
        
        textarea {
            flex: 1;
            min-height: 200px;
            padding: 0.75rem;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.3);
            background: rgba(15, 23, 42, 0.7);
            color: inherit;
            font-size: 0.95rem;
            font-family: inherit;
            resize: vertical;
        }
        
        textarea:focus {
            outline: none;
            border-color: rgba(59, 130, 246, 0.7);
            box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.3);
        }
        
        .extraction-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .stat-card {
            background: rgba(30, 41, 59, 0.65);
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid rgba(148, 163, 184, 0.15);
        }
        
        .stat-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: rgba(148, 163, 184, 0.8);
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: #38bdf8;
        }
        
        .visualization-section {
            grid-column: 1 / -1;
            height: 500px;
        }
        
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            color: rgba(148, 163, 184, 0.8);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .tab:hover {
            color: #38bdf8;
        }
        
        .tab.active {
            color: #38bdf8;
            border-bottom-color: #38bdf8;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
            color: rgba(148, 163, 184, 0.8);
        }
        
        .loading.active {
            display: block;
        }
        
        .error {
            display: none;
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            color: #fca5a5;
        }
        
        .error.active {
            display: block;
        }
        
        @media (max-width: 1200px) {
            .extraction-container {
                grid-template-columns: 1fr;
            }
            
            .visualization-section {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <h1>Entity Extraction</h1>
        <p class="subtitle">Extract entities and relationships from text using Perplexity AI</p>
    </header>

    <main class="app-main">
        <section class="extraction-container">
            <div class="input-panel panel">
                <h2>Input Text</h2>
                <label class="field">
                    <span>API Base URL</span>
                    <input id="api-base-url" type="url" placeholder="http://localhost:8000" value="http://localhost:8000" required>
                </label>
                <label class="field">
                    <span>Document Content</span>
                    <textarea id="input-text" placeholder="Enter text to extract entities from...">Acme Ventures invested $5 million in NovaBio, a Boston-based biotech startup founded by Dr. Lina Ortiz on October 22, 2024. The investment will help NovaBio develop new cancer treatments.</textarea>
                </label>
                <div class="field duo">
                    <label>
                        <span>Confidence Threshold</span>
                        <input id="confidence-threshold" type="number" min="0" max="1" step="0.05" value="0.7">
                    </label>
                    <label>
                        <span>Source Type</span>
                        <select id="source-type">
                            <option value="unknown">Unknown</option>
                            <option value="news">News</option>
                            <option value="academic">Academic</option>
                            <option value="social_media">Social Media</option>
                            <option value="document">Document</option>
                        </select>
                    </label>
                </div>
                <label class="field">
                    <span>Entity Types (comma separated, leave empty for all)</span>
                    <input id="entity-types" type="text" placeholder="person, organization, location">
                </label>
                <button type="button" id="extract-btn" class="primary">Extract Entities</button>
                <div id="loading" class="loading">Processing extraction...</div>
                <div id="error" class="error"></div>
            </div>

            <div class="output-panel panel">
                <h2>Results</h2>
                <div class="tabs">
                    <button class="tab active" data-tab="json">JSON Output</button>
                    <button class="tab" data-tab="entities">Entities</button>
                    <button class="tab" data-tab="relationships">Relationships</button>
                </div>
                
                <div id="json-tab" class="tab-content active">
                    <div class="json-output" id="json-output">
                        <pre>No extraction performed yet. Click "Extract Entities" to start.</pre>
                    </div>
                </div>
                
                <div id="entities-tab" class="tab-content">
                    <div id="entities-list" class="json-output">
                        <pre>No entities extracted yet.</pre>
                    </div>
                </div>
                
                <div id="relationships-tab" class="tab-content">
                    <div id="relationships-list" class="json-output">
                        <pre>No relationships extracted yet.</pre>
                    </div>
                </div>
                
                <div class="extraction-stats" id="stats" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-label">Entities</div>
                        <div class="stat-value" id="stat-entities">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Relationships</div>
                        <div class="stat-value" id="stat-relationships">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Processing Time</div>
                        <div class="stat-value" id="stat-time">0s</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="visualization-section panel">
            <div class="visual-header">
                <h2>Relationship Graph</h2>
                <button id="reset-graph" type="button">Reset View</button>
            </div>
            <div id="graph-container"></div>
            <div id="graph-info" class="graph-info"></div>
        </section>
    </main>

    <script src="https://unpkg.com/vis-network@9.1.2/standalone/umd/vis-network.min.js"></script>
    <script src="extraction.js" type="module"></script>
</body>
</html>

